# ๐ API ูุงุฆูุฉ ุงููุญุงุฏุซุงุช - Conversations List

## โจ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ **API ุฌุฏูุฏ** ูุนุฑุถ ูุงุฆูุฉ ุงููุญุงุฏุซุงุช ูููุณุชุฎุฏู ูุน ุฅููุงููุฉ ุงูุจุญุซ.

---

## ๐ฏ ุงูู Endpoint ุงูุฌุฏูุฏ

### GET `/api/conversations`

**ุงููุตู:** ุฌูุจ ูุงุฆูุฉ ุงููุญุงุฏุซุงุช ูููุณุชุฎุฏู ุงููุณุฌู ุฏุฎููู

**ุงููุตุงุฏูุฉ:** ูุทููุจุฉ (Bearer Token)

**Method:** `GET`

---

## ๐ฅ ุงููุนุงููุงุช (Query Parameters)

| ุงููุนุงูู | ุงูููุน | ูุทููุจ | ุงููุตู | ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ |
|---------|------|-------|-------|-------------------|
| `search` | string | ูุง | ุงูุจุญุซ ูู ุฃุณูุงุก ุงููุดุงุฑููู | - |
| `per_page` | integer | ูุง | ุนุฏุฏ ุงููุญุงุฏุซุงุช ูู ุงูุตูุญุฉ (1-100) | 20 |

---

## ๐ค ุงูุงุณุชุฌุงุจุฉ

### โ ูุฌุงุญ (200 OK) - ูุน ูุญุงุฏุซุงุช

```json
{
  "success": true,
  "message": "ุชู ุฌูุจ ุงููุญุงุฏุซุงุช ุจูุฌุงุญ",
  "data": [
    {
      "id": 1,
      "booking_id": 42,
      "other_participant": {
        "id": 20,
        "full_name": "ุณุงุฑุฉ ุฃุญูุฏ",
        "avatar": "https://example.com/avatars/sara.jpg"
      },
      "last_message": {
        "id": 105,
        "body": "ุดูุฑุงู ููุ ุณุฃุฑุงุฌุน ุงูุชูุงุฑูุฑ",
        "type": "text",
        "sender_id": 20,
        "is_from_me": false,
        "created_at": "2026-01-21T15:30:00Z"
      },
      "created_at": "2026-01-20T10:00:00Z",
      "updated_at": "2026-01-21T15:30:00Z"
    },
    {
      "id": 2,
      "booking_id": 43,
      "other_participant": {
        "id": 25,
        "full_name": "ูุญูุฏ ุนูู",
        "avatar": null
      },
      "last_message": {
        "id": 98,
        "body": "ูุชู ุงูููุนุฏ ุงููุงุฏูุ",
        "type": "text",
        "sender_id": 10,
        "is_from_me": true,
        "created_at": "2026-01-21T14:20:00Z"
      },
      "created_at": "2026-01-19T09:00:00Z",
      "updated_at": "2026-01-21T14:20:00Z"
    }
  ],
  "meta": {
    "current_page": 1,
    "from": 1,
    "last_page": 1,
    "per_page": 20,
    "to": 2,
    "total": 2
  }
}
```

---

### โ ูุฌุงุญ (200 OK) - ุจุฏูู ูุญุงุฏุซุงุช

```json
{
  "success": true,
  "message": "ูุง ุชูุฌุฏ ูุญุงุฏุซุงุช ุจุนุฏ",
  "data": []
}
```

---

### โ ุฎุทุฃ (401 Unauthorized)

```json
{
  "success": false,
  "message": "Unauthenticated",
  "status_code": 401
}
```

---

### โ ุฎุทุฃ (422 Validation Error)

```json
{
  "success": false,
  "message": "ูุฌุจ ุฃูุง ูุชุฌุงูุฒ ุนุฏุฏ ุงูุนูุงุตุฑ ูู ุงูุตูุญุฉ 100.",
  "errors": {
    "per_page": ["ูุฌุจ ุฃูุง ูุชุฌุงูุฒ ุนุฏุฏ ุงูุนูุงุตุฑ ูู ุงูุตูุญุฉ 100."]
  },
  "status_code": 422
}
```

---

## ๐ ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### ูุซุงู 1: ุฌูุจ ุฌููุน ุงููุญุงุฏุซุงุช

```bash
GET /api/conversations
Authorization: Bearer {token}
```

---

### ูุซุงู 2: ุฌูุจ ุงููุญุงุฏุซุงุช ูุน ุงูุจุญุซ

```bash
GET /api/conversations?search=ุณุงุฑุฉ
Authorization: Bearer {token}
```

**ุงููุชูุฌุฉ:** ุณูุชู ุงูุจุญุซ ูู ุงูุฃุณูุงุก ุงูุฃููู ูุงูุฃุฎูุฑุฉ ูููุดุงุฑููู

---

### ูุซุงู 3: ุฌูุจ 10 ูุญุงุฏุซุงุช ููุท

```bash
GET /api/conversations?per_page=10
Authorization: Bearer {token}
```

---

### ูุซุงู 4: ุงูุจุญุซ ูุน ุงูุชุตูุญ

```bash
GET /api/conversations?search=ุฃุญูุฏ&per_page=15
Authorization: Bearer {token}
```

---

## ๐ ุจููุฉ ุงูุจูุงูุงุช

### `other_participant` (ุงููุดุงุฑู ุงูุขุฎุฑ)

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|------|-------|
| `id` | integer | ูุนุฑู ุงููุณุชุฎุฏู |
| `full_name` | string | ุงูุงุณู ุงููุงูู |
| `avatar` | string\|null | ุฑุงุจุท ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ |

---

### `last_message` (ุขุฎุฑ ุฑุณุงูุฉ)

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|------|-------|
| `id` | integer | ูุนุฑู ุงูุฑุณุงูุฉ |
| `body` | string\|null | ูุต ุงูุฑุณุงูุฉ |
| `type` | string | ููุน ุงูุฑุณุงูุฉ (text, attachment, mixed) |
| `sender_id` | integer | ูุนุฑู ุงููุฑุณู |
| `is_from_me` | boolean | ูู ุงูุฑุณุงูุฉ ูู ุงููุณุชุฎุฏู ุงูุญุงููุ |
| `created_at` | string | ุชุงุฑูุฎ ุงูุฅุฑุณุงู (ISO 8601) |

---

## ๐จ ุงูููุฒุงุช

### โ ุงูุชุฑุชูุจ
- ุงููุญุงุฏุซุงุช ูุฑุชุจุฉ ุญุณุจ ุขุฎุฑ ุชุญุฏูุซ (ุงูุฃุญุฏุซ ุฃููุงู)
- ุงููุญุงุฏุซุงุช ุงููุดุทุฉ ุชุธูุฑ ูู ุงูุฃุนูู

### โ ุงูุจุญุซ
- ุงูุจุญุซ ูู ุงูุงุณู ุงููุงูู ูููุดุงุฑููู
- ุงูุจุญุซ ุบูุฑ ุญุณุงุณ ูุญุงูุฉ ุงูุฃุญุฑู

### โ ุงูุชุตูุญ (Pagination)
- ุฏุนู ุงูุชุตูุญ ุงูููุงุณู
- ูููู ุงูุชุญูู ูู ุนุฏุฏ ุงูุนูุงุตุฑ (1-100)
- ูุนูููุงุช ุงูุชุตูุญ ูู `meta`

### โ ุขุฎุฑ ุฑุณุงูุฉ
- ุนุฑุถ ุขุฎุฑ ุฑุณุงูุฉ ูู ูู ูุญุงุฏุซุฉ
- ูุนุฑูุฉ ุฅุฐุง ูุงูุช ุงูุฑุณุงูุฉ ููู ุฃู ูู ุงูุทุฑู ุงูุขุฎุฑ
- ุนุฑุถ ููุน ุงูุฑุณุงูุฉ (ูุตุ ูุฑููุ ูุฎุชูุท)

---

## ๐ ุงูุฃูุงู

- โ ูุชุทูุจ ูุตุงุฏูุฉ (Bearer Token)
- โ ูุนุฑุถ ููุท ูุญุงุฏุซุงุช ุงููุณุชุฎุฏู ุงููุณุฌู
- โ ูุง ูููู ุฑุคูุฉ ูุญุงุฏุซุงุช ุงููุณุชุฎุฏููู ุงูุขุฎุฑูู
- โ ุงูุชุญูู ูู ุตุญุฉ ุงููุฏุฎูุงุช

---

## ๐ก ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### 1๏ธโฃ ุดุงุดุฉ ุงููุญุงุฏุซุงุช ุงูุฑุฆูุณูุฉ
```javascript
// ุฌูุจ ุฌููุน ุงููุญุงุฏุซุงุช
fetch('/api/conversations', {
  headers: {
    'Authorization': 'Bearer ' + token
  }
})
```

### 2๏ธโฃ ุงูุจุญุซ ูู ุงููุญุงุฏุซุงุช
```javascript
// ุงูุจุญุซ ุนู ูุญุงุฏุซุฉ ูุนููุฉ
fetch('/api/conversations?search=' + searchTerm, {
  headers: {
    'Authorization': 'Bearer ' + token
  }
})
```

### 3๏ธโฃ ุงูุชุตูุญ (Load More)
```javascript
// ุฌูุจ ุงูุตูุญุฉ ุงูุชุงููุฉ
fetch('/api/conversations?page=2&per_page=20', {
  headers: {
    'Authorization': 'Bearer ' + token
  }
})
```

---

## ๐ฏ Postman

### ุฅุถุงูุฉ ุงูุทูุจ ุฅูู Postman:

```
Method: GET
URL: {{base_url}}/conversations
Headers:
  - Accept: application/json
  - Authorization: Bearer {{token}}
Query Params:
  - search: (optional)
  - per_page: (optional, default: 20)
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชุฑุชูุจ:** ุงููุญุงุฏุซุงุช ูุฑุชุจุฉ ุญุณุจ `updated_at` (ุงูุฃุญุฏุซ ุฃููุงู)
2. **ุงููุดุงุฑู ุงูุขุฎุฑ:** ูุชู ุนุฑุถ ุจูุงูุงุช ุงููุดุงุฑู ุงูุขุฎุฑ ููุท (ููุณ ุงููุณุชุฎุฏู ุงูุญุงูู)
3. **ุขุฎุฑ ุฑุณุงูุฉ:** ุฅุฐุง ูู ุชูุฌุฏ ุฑุณุงุฆูุ ุณูููู `last_message` = `null`
4. **ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ:** ุฅุฐุง ูู ุชูุฌุฏ ุตูุฑุฉุ ุณูููู `avatar` = `null`
5. **ุงูุจุญุซ:** ูุจุญุซ ููุท ูู ุฃุณูุงุก ุงููุดุงุฑููู ุงูุขุฎุฑูู (ููุณ ูู ูุต ุงูุฑุณุงุฆู)

---

## ๐ ุงูุชูุงูู ูุน ุงูู APIs ุงูุฃุฎุฑู

### ุจุนุฏ ุฌูุจ ุงููุงุฆูุฉ:
1. ุงุถุบุท ุนูู ูุญุงุฏุซุฉ โ ุงุณุชุฎุฏู `GET /api/conversations/{id}/messages`
2. ุฃุฑุณู ุฑุณุงูุฉ โ ุงุณุชุฎุฏู `POST /api/conversations/{id}/messages`
3. ุญููู ูุฑูู โ ุงุณุชุฎุฏู `GET /api/attachments/{id}`

---

## โจ ูุซุงู ูุงูู ูู Flutter/React Native

```dart
// Flutter Example
Future<List<Conversation>> getConversations({String? search}) async {
  final response = await http.get(
    Uri.parse('$baseUrl/conversations${search != null ? '?search=$search' : ''}'),
    headers: {
      'Authorization': 'Bearer $token',
      'Accept': 'application/json',
    },
  );

  if (response.statusCode == 200) {
    final data = json.decode(response.body);
    if (data['data'].isEmpty) {
      // ูุง ุชูุฌุฏ ูุญุงุฏุซุงุช
      return [];
    }
    return (data['data'] as List)
        .map((json) => Conversation.fromJson(json))
        .toList();
  } else {
    throw Exception('ูุดู ุฌูุจ ุงููุญุงุฏุซุงุช');
  }
}
```

---

**โ API ุฌุงูุฒ ููุงุณุชุฎุฏุงู!**

---

*ุชุงุฑูุฎ ุงูุฅูุดุงุก: 21 ููุงูุฑ 2025*
