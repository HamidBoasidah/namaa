{
	"info": {
		"_postman_id": "reviews-api",
		"name": "Reviews & Ratings API",
		"description": "API لإدارة التقييمات والمراجعات - إنشاء، تعديل، حذف، وعرض التقييمات للحجوزات المكتملة",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000/api",
			"type": "string"
		},
		{
			"key": "token",
			"value": "",
			"type": "string"
		},
		{
			"key": "review_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "booking_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "consultant_id",
			"value": "1",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Auth",
			"item": [
				{
					"name": "Login (Client)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.data && jsonData.data.token) {",
									"    pm.collectionVariables.set('token', jsonData.data.token);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"client@example.com\",\n    \"password\": \"password\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/login",
							"host": ["{{base_url}}"],
							"path": ["login"]
						},
						"description": "تسجيل دخول كعميل لإنشاء وإدارة التقييمات"
					}
				},
				{
					"name": "Login (Consultant)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.data && jsonData.data.token) {",
									"    pm.collectionVariables.set('token', jsonData.data.token);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"consultant@example.com\",\n    \"password\": \"password\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/login",
							"host": ["{{base_url}}"],
							"path": ["login"]
						},
						"description": "تسجيل دخول كمستشار لعرض التقييمات الخاصة به"
					}
				}
			]
		},
		{
			"name": "Reviews",
			"item": [
				{
					"name": "Get All Reviews (By Rating)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/reviews?per_page=10&page=1",
							"host": ["{{base_url}}"],
							"path": ["reviews"],
							"query": [
								{
									"key": "per_page",
									"value": "10",
									"description": "عدد النتائج في الصفحة (افتراضي: 10)"
								},
								{
									"key": "page",
									"value": "1",
									"description": "رقم الصفحة"
								}
							]
						},
						"description": "عرض جميع التقييمات في النظام مرتبة من الأعلى تقييماً إلى الأقل\n\n⚠️ هذا الـ endpoint عام ولا يتطلب تسجيل دخول\n\nالترتيب:\n1. حسب التقييم (من 5 إلى 1)\n2. حسب تاريخ الإنشاء (الأحدث أولاً) للتقييمات المتساوية\n\nمفيد لعرض:\n- أفضل التقييمات في الصفحة الرئيسية\n- قسم \"آراء العملاء\" في الموقع\n- عرض التقييمات المميزة"
					}
				},
				{
					"name": "Create Review",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.data && jsonData.data.id) {",
									"    pm.collectionVariables.set('review_id', jsonData.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"booking_id\": 1,\n    \"rating\": 5,\n    \"comment\": \"استشارة ممتازة جداً، المستشار محترف ومتعاون\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews",
							"host": ["{{base_url}}"],
							"path": ["reviews"]
						},
						"description": "إنشاء تقييم لحجز مكتمل\n\nملاحظات مهمة:\n- يجب تسجيل الدخول كعميل (صاحب الحجز)\n- الحجز يجب أن يكون في حالة 'completed'\n- يمكن إنشاء تقييم واحد فقط لكل حجز\n- consultant_id و client_id يتم استخراجهما تلقائياً من الحجز\n\nالحقول:\n- booking_id: معرف الحجز (مطلوب)\n- rating: التقييم من 1 إلى 5 (مطلوب)\n- comment: التعليق (اختياري، حد أقصى 2000 حرف)"
					}
				},
				{
					"name": "Get Review Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/reviews/{{review_id}}",
							"host": ["{{base_url}}"],
							"path": ["reviews", "{{review_id}}"]
						},
						"description": "عرض تفاصيل تقييم معين\n\nيمكن لأي مستخدم مسجل دخوله عرض التقييمات"
					}
				},
				{
					"name": "Update Review",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"rating\": 4,\n    \"comment\": \"استشارة جيدة، لكن كان هناك بعض التأخير في البداية\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews/{{review_id}}",
							"host": ["{{base_url}}"],
							"path": ["reviews", "{{review_id}}"]
						},
						"description": "تعديل تقييم موجود\n\nملاحظات:\n- يمكن فقط لصاحب التقييم (العميل) تعديله\n- يمكن تعديل التقييم والتعليق\n\nالحقول:\n- rating: التقييم من 1 إلى 5 (مطلوب)\n- comment: التعليق (اختياري، حد أقصى 2000 حرف)"
					}
				},
				{
					"name": "Delete Review",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/reviews/{{review_id}}",
							"host": ["{{base_url}}"],
							"path": ["reviews", "{{review_id}}"]
						},
						"description": "حذف تقييم (soft delete)\n\nملاحظات:\n- يمكن فقط لصاحب التقييم (العميل) حذفه\n- الحذف يكون soft delete (يبقى في قاعدة البيانات)\n- بعد الحذف، لا يمكن إنشاء تقييم جديد لنفس الحجز"
					}
				},
				{
					"name": "Get My Reviews",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/my/reviews?per_page=10&page=1",
							"host": ["{{base_url}}"],
							"path": ["my", "reviews"],
							"query": [
								{
									"key": "per_page",
									"value": "10",
									"description": "عدد النتائج في الصفحة (افتراضي: 10)"
								},
								{
									"key": "page",
									"value": "1",
									"description": "رقم الصفحة"
								}
							]
						},
						"description": "عرض قائمة تقييماتي كعميل\n\nيعرض جميع التقييمات التي كتبتها مع معلومات الحجز والمستشار\n\nالنتائج مرتبة من الأحدث إلى الأقدم"
					}
				}
			]
		},
		{
			"name": "Consultant Reviews",
			"item": [
				{
					"name": "Get Consultant Reviews",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"description": "اختياري - يمكن إزالته للوصول العام",
								"disabled": true
							}
						],
						"url": {
							"raw": "{{base_url}}/consultants/{{consultant_id}}/reviews?per_page=10&page=1",
							"host": ["{{base_url}}"],
							"path": ["consultants", "{{consultant_id}}", "reviews"],
							"query": [
								{
									"key": "per_page",
									"value": "10",
									"description": "عدد النتائج في الصفحة (افتراضي: 10)"
								},
								{
									"key": "page",
									"value": "1",
									"description": "رقم الصفحة"
								}
							]
						},
						"description": "عرض قائمة تقييمات مستشار معين\n\n⚠️ هذا الـ endpoint عام ولا يتطلب تسجيل دخول\n\nيعرض جميع التقييمات للمستشار مع معلومات العميل والحجز\n\nالنتائج مرتبة من الأحدث إلى الأقدم\n\nمفيد لعرض التقييمات في الملف الشخصي العام للمستشار\n\nملاحظة: Authorization header معطل افتراضياً، يمكنك تفعيله إذا أردت الاختبار مع token"
					}
				}
			]
		},
		{
			"name": "Complete Review Flow",
			"item": [
				{
					"name": "1. Login as Client",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.data && jsonData.data.token) {",
									"    pm.collectionVariables.set('token', jsonData.data.token);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"client@example.com\",\n    \"password\": \"password\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/login",
							"host": ["{{base_url}}"],
							"path": ["login"]
						}
					}
				},
				{
					"name": "2. Create Review for Completed Booking",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"var jsonData = pm.response.json();",
									"if (jsonData.data && jsonData.data.id) {",
									"    pm.collectionVariables.set('review_id', jsonData.data.id);",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"booking_id\": 1,\n    \"rating\": 5,\n    \"comment\": \"تجربة رائعة! المستشار كان محترفاً جداً وساعدني كثيراً\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews",
							"host": ["{{base_url}}"],
							"path": ["reviews"]
						}
					}
				},
				{
					"name": "3. View Review Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/reviews/{{review_id}}",
							"host": ["{{base_url}}"],
							"path": ["reviews", "{{review_id}}"]
						}
					}
				},
				{
					"name": "4. Update Review",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"rating\": 4,\n    \"comment\": \"تجربة جيدة بشكل عام، لكن كان هناك بعض التأخير\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews/{{review_id}}",
							"host": ["{{base_url}}"],
							"path": ["reviews", "{{review_id}}"]
						}
					}
				},
				{
					"name": "5. View My Reviews",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/my/reviews",
							"host": ["{{base_url}}"],
							"path": ["my", "reviews"]
						}
					}
				},
				{
					"name": "6. View All Reviews (By Rating)",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/reviews?per_page=10",
							"host": ["{{base_url}}"],
							"path": ["reviews"],
							"query": [
								{
									"key": "per_page",
									"value": "10"
								}
							]
						},
						"description": "عرض جميع التقييمات مرتبة من الأعلى تقييماً"
					}
				},
				{
					"name": "7. View Consultant Reviews",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/consultants/1/reviews",
							"host": ["{{base_url}}"],
							"path": ["consultants", "1", "reviews"]
						},
						"description": "عرض تقييمات المستشار - لا يتطلب تسجيل دخول"
					}
				}
			],
			"description": "مثال على التدفق الكامل لإدارة التقييمات:\n\n1. تسجيل الدخول كعميل\n2. إنشاء تقييم لحجز مكتمل\n3. عرض تفاصيل التقييم\n4. تعديل التقييم\n5. عرض جميع تقييماتي\n6. عرض جميع التقييمات مرتبة من الأعلى تقييماً (عام)\n7. عرض تقييمات مستشار معين (عام)\n\nملاحظة: يمكن حذف التقييم في أي وقت باستخدام DELETE endpoint"
		},
		{
			"name": "Error Scenarios",
			"item": [
				{
					"name": "Create Review - Invalid Rating (0)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"booking_id\": 1,\n    \"rating\": 0,\n    \"comment\": \"تقييم بقيمة غير صحيحة\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews",
							"host": ["{{base_url}}"],
							"path": ["reviews"]
						},
						"description": "محاولة إنشاء تقييم بقيمة أقل من 1\n\nالنتيجة المتوقعة: خطأ 422 - التقييم يجب أن يكون 1 على الأقل"
					}
				},
				{
					"name": "Create Review - Invalid Rating (6)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"booking_id\": 1,\n    \"rating\": 6,\n    \"comment\": \"تقييم بقيمة أكبر من المسموح\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews",
							"host": ["{{base_url}}"],
							"path": ["reviews"]
						},
						"description": "محاولة إنشاء تقييم بقيمة أكبر من 5\n\nالنتيجة المتوقعة: خطأ 422 - التقييم يجب أن يكون 5 كحد أقصى"
					}
				},
				{
					"name": "Create Review - Non-existent Booking",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"booking_id\": 99999,\n    \"rating\": 5,\n    \"comment\": \"تقييم لحجز غير موجود\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews",
							"host": ["{{base_url}}"],
							"path": ["reviews"]
						},
						"description": "محاولة إنشاء تقييم لحجز غير موجود\n\nالنتيجة المتوقعة: خطأ 422 - الحجز غير موجود"
					}
				},
				{
					"name": "Create Review - Duplicate Review",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"booking_id\": 1,\n    \"rating\": 5,\n    \"comment\": \"محاولة إنشاء تقييم ثاني لنفس الحجز\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews",
							"host": ["{{base_url}}"],
							"path": ["reviews"]
						},
						"description": "محاولة إنشاء تقييم ثاني لحجز تم تقييمه مسبقاً\n\nالنتيجة المتوقعة: خطأ 422 - تم تقييم هذا الحجز مسبقاً"
					}
				},
				{
					"name": "Update Review - Not Owner",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"description": "استخدم token لمستخدم آخر"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"rating\": 1,\n    \"comment\": \"محاولة تعديل تقييم شخص آخر\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reviews/{{review_id}}",
							"host": ["{{base_url}}"],
							"path": ["reviews", "{{review_id}}"]
						},
						"description": "محاولة تعديل تقييم لا يخصك\n\nالنتيجة المتوقعة: خطأ 403 - لا يمكنك تعديل تقييم لا يخصك"
					}
				},
				{
					"name": "Delete Review - Not Owner",
					"request": {
						"method": "DELETE",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}",
								"description": "استخدم token لمستخدم آخر"
							}
						],
						"url": {
							"raw": "{{base_url}}/reviews/{{review_id}}",
							"host": ["{{base_url}}"],
							"path": ["reviews", "{{review_id}}"]
						},
						"description": "محاولة حذف تقييم لا يخصك\n\nالنتيجة المتوقعة: خطأ 403 - لا يمكنك حذف تقييم لا يخصك"
					}
				}
			],
			"description": "أمثلة على سيناريوهات الأخطاء المختلفة:\n\n- تقييم بقيمة غير صحيحة (أقل من 1 أو أكبر من 5)\n- حجز غير موجود\n- تقييم مكرر لنفس الحجز\n- محاولة تعديل/حذف تقييم لا يخصك"
		}
	]
}
